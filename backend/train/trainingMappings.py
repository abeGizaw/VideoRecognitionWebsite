import pandas as pd
import os
import shutil
index_to_label_k400 = {
0:"abseiling",
1:"air drumming",
2:"answering questions",
3:"applauding",
4:"applying cream",
5:"archery",
6:"arm wrestling",
7:"arranging flowers",
8:"assembling computer",
9:"auctioning",
10:"baby waking up",
11:"baking cookies",
12:"balloon blowing",
13:"bandaging",
14:"barbequing",
15:"bartending",
16:"beatboxing",
17:"bee keeping",
18:"belly dancing",
19:"bench pressing",
20:"bending back",
21:"bending metal",
22:"biking through snow",
23:"blasting sand",
24:"blowing glass",
25:"blowing leaves",
26:"blowing nose",
27:"blowing out candles",
28:"bobsledding",
29:"bookbinding",
30:"bouncing on trampoline",
31:"bowling",
32:"braiding hair",
33:"breading or breadcrumbing",
34:"breakdancing",
35:"brush painting",
36:"brushing hair",
37:"brushing teeth",
38:"building cabinet",
39:"building shed",
40:"bungee jumping",
41:"busking",
42:"canoeing or kayaking",
43:"capoeira",
44:"carrying baby",
45:"cartwheeling",
46:"carving pumpkin",
47:"catching fish",
48:"catching or throwing baseball",
49:"catching or throwing frisbee",
50:"catching or throwing softball",
51:"celebrating",
52:"changing oil",
53:"changing wheel",
54:"checking tires",
55:"cheerleading",
56:"chopping wood",
57:"clapping",
58:"clay pottery making",
59:"clean and jerk",
60:"cleaning floor",  #CLEANING
61:"cleaning gutters",
62:"cleaning pool",
63:"cleaning shoes",
64:"cleaning toilet",
65:"cleaning windows",
66:"climbing a rope", #CLIMBING
67:"climbing ladder",
68:"climbing tree",
69:"contact juggling",
70:"cooking chicken", #COOKING
71:"cooking egg",
72:"cooking on campfire",
73:"cooking sausages",
74:"counting money",
75:"country line dancing",
76:"cracking neck",
77:"crawling baby",
78:"crossing river",
79:"crying",
80:"curling hair",
81:"cutting nails",
82:"cutting pineapple",
83:"cutting watermelon",
84:"dancing ballet",
85:"dancing charleston",
86:"dancing gangnam style",
87:"dancing macarena",
88:"deadlifting",
89:"decorating the christmas tree",
90:"digging",
91:"dining",
92:"disc golfing",
93:"diving cliff",
94:"dodgeball",
95:"doing aerobics",
96:"doing laundry",
97:"doing nails",
98:"drawing",
99:"dribbling basketball",
100:"drinking",
101:"drinking beer",
102:"drinking shots",
103:"driving car",
104:"driving tractor",
105:"drop kicking",
106:"drumming fingers",
107:"dunking basketball",
108:"dying hair",
109:"eating burger", #EATING
110:"eating cake",
111:"eating carrots",
112:"eating chips",
113:"eating doughnuts",
114:"eating hotdog",
115:"eating ice cream",
116:"eating spaghetti",
117:"eating watermelon",
118:"egg hunting",
119:"exercising arm",
120:"exercising with an exercise ball",
121:"extinguishing fire",
122:"faceplanting",
123:"feeding birds",
124:"feeding fish",
125:"feeding goats",
126:"filling eyebrows",
127:"finger snapping",
128:"fixing hair",
129:"flipping pancake",
130:"flying kite",
131:"folding clothes",
132:"folding napkins",
133:"folding paper",
134:"front raises",
135:"frying vegetables",
136:"garbage collecting",
137:"gargling",
138:"getting a haircut",
139:"getting a tattoo",
140:"giving or receiving award",
141:"golf chipping", #Golfing
142:"golf driving",
143:"golf putting",
144:"grinding meat",
145:"grooming dog",
146:"grooming horse",
147:"gymnastics tumbling",
148:"hammer throw",
149:"headbanging",
150:"headbutting",
151:"high jump",
152:"high kick",
153:"hitting baseball",
154:"hockey stop",
155:"holding snake",
156:"hopscotch",
157:"hoverboarding",
158:"hugging",
159:"hula hooping",
160:"hurdling",
161:"hurling (sport)",
162:"ice climbing",
163:"ice fishing",
164:"ice skating",
165:"ironing",
166:"javelin throw",
167:"jetskiing",
168:"jogging",
169:"juggling balls",
170:"juggling fire",
171:"juggling soccer ball",
172:"jumping into pool",
173:"jumpstyle dancing",
174:"kicking field goal",
175:"kicking soccer ball",
176:"kissing",
177:"kitesurfing",
178:"knitting",
179:"krumping",
180:"laughing",
181:"laying bricks",
182:"long jump",
183:"lunge",
184:"making a cake",
185:"making a sandwich",
186:"making bed",
187:"making jewelry",
188:"making pizza",
189:"making snowman",
190:"making sushi",
191:"making tea",
192:"marching",
193:"massaging back", #MASSAGING
194:"massaging feet",
195:"massaging legs",
196:"massaging person's head",
197:"milking cow",
198:"mopping floor",
199:"motorcycling",
200:"moving furniture",
201:"mowing lawn",
202:"news anchoring",
203:"opening bottle",
204:"opening present",
205:"paragliding",
206:"parasailing",
207:"parkour",
208:"passing American football (in game)",
209:"passing American football (not in game)",
210:"peeling apples",
211:"peeling potatoes",
212:"petting animal (not cat)",
213:"petting cat",
214:"picking fruit",
215:"planting trees",
216:"plastering",
217:"playing accordion",
218:"playing badminton",
219:"playing bagpipes",
220:"playing basketball",
221:"playing bass guitar",
222:"playing cards",
223:"playing cello",
224:"playing chess",
225:"playing clarinet",
226:"playing controller",
227:"playing cricket",
228:"playing cymbals",
229:"playing didgeridoo",
230:"playing drums",
231:"playing flute",
232:"playing guitar",
233:"playing harmonica",
234:"playing harp",
235:"playing ice hockey",
236:"playing keyboard",
237:"playing kickball",
238:"playing monopoly",
239:"playing organ",
240:"playing paintball",
241:"playing piano",
242:"playing poker",
243:"playing recorder",
244:"playing saxophone",
245:"playing squash or racquetball",
246:"playing tennis",
247:"playing trombone",
248:"playing trumpet",
249:"playing ukulele",
250:"playing violin",
251:"playing volleyball",
252:"playing xylophone",
253:"pole vault",
254:"presenting weather forecast",
255:"pull ups",
256:"pumping fist",
257:"pumping gas",
258:"punching bag",
259:"punching person (boxing)",
260:"push up",
261:"pushing car",
262:"pushing cart",
263:"pushing wheelchair",
264:"reading book",
265:"reading newspaper",
266:"recording music",
267:"riding a bike",
268:"riding camel",
269:"riding elephant",
270:"riding mechanical bull",
271:"riding mountain bike",
272:"riding mule",
273:"riding or walking with horse",
274:"riding scooter",
275:"riding unicycle",
276:"ripping paper",
277:"robot dancing",
278:"rock climbing",
279:"rock scissors paper",
280:"roller skating",
281:"running on treadmill",
282:"sailing",
283:"salsa dancing",
284:"sanding floor",
285:"scrambling eggs",
286:"scuba diving",
287:"setting table",
288:"shaking hands",
289:"shaking head",
290:"sharpening knives",
291:"sharpening pencil",
292:"shaving head",
293:"shaving legs",
294:"shearing sheep",
295:"shining shoes",
296:"shooting basketball",
297:"shooting goal (soccer)",
298:"shot put",
299:"shoveling snow",
300:"shredding paper",
301:"shuffling cards",
302:"side kick",
303:"sign language interpreting",
304:"singing",
305:"situp",
306:"skateboarding",
307:"ski jumping", #Skiing
308:"skiing (not slalom or crosscountry)",
309:"skiing crosscountry",
310:"skiing slalom",
311:"skipping rope",
312:"skydiving",
313:"slacklining",
314:"slapping",
315:"sled dog racing",
316:"smoking",
317:"smoking hookah",
318:"snatch weight lifting",
319:"sneezing",
320:"sniffing",
321:"snorkeling",
322:"snowboarding",
323:"snowkiting",
324:"snowmobiling",
325:"somersaulting",
326:"spinning poi",
327:"spray painting",
328:"spraying",
329:"springboard diving",
330:"squat",
331:"sticking tongue out",
332:"stomping grapes",
333:"stretching arm",
334:"stretching leg",
335:"strumming guitar",
336:"surfing crowd",
337:"surfing water",
338:"sweeping floor",
339:"swimming backstroke", #SWIMMING
340:"swimming breast stroke",
341:"swimming butterfly stroke",
342:"swing dancing",
343:"swinging legs",
344:"swinging on something",
345:"sword fighting",
346:"tai chi",
347:"taking a shower",
348:"tango dancing",
349:"tap dancing",
350:"tapping guitar",
351:"tapping pen",
352:"tasting beer",
353:"tasting food",
354:"testifying",
355:"texting",
356:"throwing axe",
357:"throwing ball",
358:"throwing discus",
359:"tickling",
360:"tobogganing",
361:"tossing coin",
362:"tossing salad",
363:"training dog",
364:"trapezing",
365:"trimming or shaving beard",
366:"trimming trees",
367:"triple jump",
368:"tying bow tie",
369:"tying knot (not on a tie)",
370:"tying tie",
371:"unboxing",
372:"unloading truck",
373:"using computer",
374:"using remote controller (not gaming)",
375:"using segway",
376:"vault",
377:"waiting in line",
378:"walking the dog",
379:"washing dishes",
380:"washing feet",
381:"washing hair",
382:"washing hands",
383:"water skiing",
384:"water sliding",
385:"watering plants",
386:"waxing back", #Waxing
387:"waxing chest",
388:"waxing eyebrows",
389:"waxing legs",
390:"weaving basket",
391:"welding",
392:"whistling",
393:"windsurfing",
394:"wrapping present",
395:"wrestling",
396:"writing",
397:"yawning",
398:"yoga",
399:"zumba",
400:"adjusting glasses"
}


index_to_label_k400_generalized = {
    0: "abseiling",
    1: "air drumming",
    2: "answering questions",
    3: "applauding",
    4: "applying cream",
    5: "archery",
    6: "arm wrestling",
    7: "arranging flowers",
    8: "assembling computer",
    9: "auctioning",
    10: "baby waking up",
    11: "baking cookies",
    12: "balloon blowing",
    13: "bandaging",
    14: "barbequing",
    15: "bartending",
    16: "beatboxing",
    17: "bee keeping",
    18: "belly dancing",
    19: "bench pressing",
    20: "bending back",
    21: "bending metal",
    22: "biking through snow",
    23: "blasting sand",
    24: "blowing glass",
    25: "blowing leaves",
    26: "blowing nose",
    27: "blowing out candles",
    28: "bobsledding",
    29: "bookbinding",
    30: "bouncing on trampoline",
    31: "bowling",
    32: "braiding hair",
    33: "breading or breadcrumbing",
    34: "breakdancing",
    35: "brush painting",
    36: "brushing hair",
    37: "brushing teeth",
    38: "building cabinet",
    39: "building shed",
    40: "bungee jumping",
    41: "busking",
    42: "canoeing or kayaking",
    43: "capoeira",
    44: "carrying baby",
    45: "cartwheeling",
    46: "carving pumpkin",
    47: "catching fish",
    48: "catching or throwing baseball",
    49: "catching or throwing frisbee",
    50: "catching or throwing softball",
    51: "celebrating",
    52: "changing oil",
    53: "changing wheel",
    54: "checking tires",
    55: "cheerleading",
    56: "chopping wood",
    57: "clapping",
    58: "clay pottery making",
    59: "clean and jerk",
    60: "cleaning",
    61: "climbing",
    62: "contact juggling",
    63: "cooking",
    64: "cooking on campfire",
    65: "counting money",
    66: "country line dancing",
    67: "cracking neck",
    68: "crawling baby",
    69: "crossing river",
    70: "crying",
    71: "curling hair",
    72: "cutting nails",
    73: "cutting pineapple",
    74: "cutting watermelon",
    75: "dancing ballet",
    76: "dancing charleston",
    77: "dancing gangnam style",
    78: "dancing macarena",
    79: "deadlifting",
    80: "decorating the christmas tree",
    81: "digging",
    82: "dining",
    83: "disc golfing",
    84: "diving cliff",
    85: "dodgeball",
    86: "doing aerobics",
    87: "doing laundry",
    88: "doing nails",
    89: "drawing",
    90: "dribbling basketball",
    91: "drinking",
    92: "drinking beer",
    93: "drinking shots",
    94: "driving car",
    95: "driving tractor",
    96: "drop kicking",
    97: "drumming fingers",
    98: "dunking basketball",
    99: "dying hair",
    100: "eating",
    101: "egg hunting",
    102: "exercising arm",
    103: "exercising with an exercise ball",
    104: "extinguishing fire",
    105: "faceplanting",
    106: "feeding birds",
    107: "feeding fish",
    108: "feeding goats",
    109: "filling eyebrows",
    110: "finger snapping",
    111: "fixing hair",
    112: "flipping pancake",
    113: "flying kite",
    114: "folding clothes",
    115: "folding napkins",
    116: "folding paper",
    117: "front raises",
    118: "frying vegetables",
    119: "garbage collecting",
    120: "gargling",
    121: "getting a haircut",
    122: "getting a tattoo",
    123: "giving or receiving award",
    124: "golf",
    125: "grinding meat",
    126: "grooming dog",
    127: "grooming horse",
    128: "gymnastics tumbling",
    129: "hammer throw",
    130: "headbanging",
    131: "headbutting",
    132: "high jump",
    133: "high kick",
    134: "hitting baseball",
    135: "hockey stop",
    136: "holding snake",
    137: "hopscotch",
    138: "hoverboarding",
    139: "hugging",
    140: "hula hooping",
    141: "hurdling",
    142: "hurling (sport)",
    143: "ice climbing",
    144: "ice fishing",
    145: "ice skating",
    146: "ironing",
    147: "javelin throw",
    148: "jetskiing",
    149: "jogging",
    150: "juggling balls",
    151: "juggling fire",
    152: "juggling soccer ball",
    153: "jumping into pool",
    154: "jumpstyle dancing",
    155: "kicking field goal",
    156: "kicking soccer ball",
    157: "kissing",
    158: "kitesurfing",
    159: "knitting",
    160: "krumping",
    161: "laughing",
    162: "laying bricks",
    163: "long jump",
    164: "lunge",
    165: "making a cake",
    166: "making a sandwich",
    167: "making bed",
    168: "making jewelry",
    169: "making pizza",
    170: "making snowman",
    171: "making sushi",
    172: "making tea",
    173: "marching",
    174: "massaging",
    175: "milking cow",
    176: "mopping floor",
    177: "motorcycling",
    178: "moving furniture",
    179: "mowing lawn",
    180: "news anchoring",
    181: "opening bottle",
    182: "opening present",
    183: "paragliding",
    184: "parasailing",
    185: "parkour",
    186: "passing American football (in game)",
    187: "passing American football (not in game)",
    188: "peeling apples",
    189: "peeling potatoes",
    190: "petting animal (not cat)",
    191: "petting cat",
    192: "picking fruit",
    193: "planting trees",
    194: "plastering",
    195: "playing accordion",
    196: "playing badminton",
    197: "playing bagpipes",
    198: "playing basketball",
    199: "playing bass guitar",
    200: "playing cards",
    201: "playing cello",
    202: "playing chess",
    203: "playing clarinet",
    204: "playing controller",
    205: "playing cricket",
    206: "playing cymbals",
    207: "playing didgeridoo",
    208: "playing drums",
    209: "playing flute",
    210: "playing guitar",
    211: "playing harmonica",
    212: "playing harp",
    213: "playing ice hockey",
    214: "playing keyboard",
    215: "playing kickball",
    216: "playing monopoly",
    217: "playing organ",
    218: "playing paintball",
    219: "playing piano",
    220: "playing poker",
    221: "playing recorder",
    222: "playing saxophone",
    223: "playing squash or racquetball",
    224: "playing tennis",
    225: "playing trombone",
    226: "playing trumpet",
    227: "playing ukulele",
    228: "playing violin",
    229: "playing volleyball",
    230: "playing xylophone",
    231: "pole vault",
    232: "presenting weather forecast",
    233: "pull ups",
    234: "pumping fist",
    235: "pumping gas",
    236: "punching bag",
    237: "punching person (boxing)",
    238: "push up",
    239: "pushing car",
    240: "pushing cart",
    241: "pushing wheelchair",
    242: "reading book",
    243: "reading newspaper",
    244: "recording music",
    245: "riding a bike",
    246: "riding camel",
    247: "riding elephant",
    248: "riding mechanical bull",
    249: "riding mountain bike",
    250: "riding mule",
    251: "riding or walking with horse",
    252: "riding scooter",
    253: "riding unicycle",
    254: "ripping paper",
    255: "robot dancing",
    256: "rock climbing",
    257: "rock scissors paper",
    258: "roller skating",
    259: "running on treadmill",
    260: "sailing",
    261: "salsa dancing",
    262: "sanding floor",
    263: "scrambling eggs",
    264: "scuba diving",
    265: "setting table",
    266: "shaking hands",
    267: "shaking head",
    268: "sharpening knives",
    269: "sharpening pencil",
    270: "shaving head",
    271: "shaving legs",
    272: "shearing sheep",
    273: "shining shoes",
    274: "shooting basketball",
    275: "shooting goal (soccer)",
    276: "shot put",
    277: "shoveling snow",
    278: "shredding paper",
    279: "shuffling cards",
    280: "side kick",
    281: "sign language interpreting",
    282: "singing",
    283: "situp",
    284: "skateboarding",
    285: "ski jumping",
    286: "skiing",
    287: "skipping rope",
    288: "skydiving",
    289: "slacklining",
    290: "slapping",
    291: "sled dog racing",
    292: "smoking",
    293: "smoking hookah",
    294: "snatch weight lifting",
    295: "sneezing",
    296: "sniffing",
    297: "snorkeling",
    298: "snowboarding",
    299: "snowkiting",
    300: "snowmobiling",
    301: "somersaulting",
    302: "spinning poi",
    303: "spray painting",
    304: "spraying",
    305: "springboard diving",
    306: "squat",
    307: "sticking tongue out",
    308: "stomping grapes",
    309: "stretching arm",
    310: "stretching leg",
    311: "strumming guitar",
    312: "surfing crowd",
    313: "surfing water",
    314: "sweeping floor",
    315: "swimming",
    316: "swing dancing",
    317: "swinging legs",
    318: "swinging on something",
    319: "sword fighting",
    320: "tai chi",
    321: "taking a shower",
    322: "tango dancing",
    323: "tap dancing",
    324: "tapping guitar",
    325: "tapping pen",
    326: "tasting beer",
    327: "tasting food",
    328: "testifying",
    329: "texting",
    330: "throwing axe",
    331: "throwing ball",
    332: "throwing discus",
    333: "tickling",
    334: "tobogganing",
    335: "tossing coin",
    336: "tossing salad",
    337: "training dog",
    338: "trapezing",
    339: "trimming or shaving beard",
    340: "trimming trees",
    341: "triple jump",
    342: "tying bow tie",
    343: "tying knot (not on a tie)",
    344: "tying tie",
    345: "unboxing",
    346: "unloading truck",
    347: "using computer",
    348: "using remote controller (not gaming)",
    349: "using segway",
    350: "vault",
    351: "waiting in line",
    352: "walking the dog",
    353: "washing dishes",
    354: "washing feet",
    355: "washing hair",
    356: "washing hands",
    357: "water skiing",
    358: "water sliding",
    359: "watering plants",
    360: "waxing",
    361: "weaving basket",
    362: "welding",
    363: "whistling",
    364: "windsurfing",
    365: "wrapping present",
    366: "wrestling",
    367: "writing",
    368: "yawning",
    369: "yoga",
    370: "zumba",
    371: "adjusting glasses",
    372: "bouncing ball (not juggling)",
    373: "blending fruit",
    374: "checking watch",
    375: "doing sudoku",
    376: "flipping bottle",
    377: "high fiving",
    378: "listening with headphones",
    379: "milking goat",
    380: "moving baby",
    381: "playing slot machines",
    382: "shoot dance",
    383: "shouting",
    384: "splashing water",
    385: "watching tv",
    386: "winking",
    387: "alligator wrestling"
}
    

label_to_index_k400 = {label: idx for idx, label in index_to_label_k400.items()}

#ADD: Splashing water, high fiving, bouncing ball, doing sudoku, ship dance, checking watch, playing slot machines, blending fruit, flipping bottle, milking goat



unwanted_labels = ["Doing other things", "no gesture"]
new_classes = ['adjusting glasses'] # , 'acting in play', 'alligator wrestling']


generalized = ['cleaning', 'climbing', 'cooking', 'eating', 'golf', 'massaging', 'passing American football', 'shaving', 'skiing', 'swimming', 'waxing']
skipped_labels = ['disc golfing','ice climbing','rock climbing','cooking on campfire','trimming or shaving beard','water skiing','jetskiing']
# df = pd.DataFrame(list(index_to_label_k400.items()))
# df.to_csv('400mappings.csv',index=False)
# print(os.getcwd())



def combineLabels(dataset_dir):
    for newFolderName in generalized:
        new_folder_path = os.path.join(dataset_dir, newFolderName)
        os.makedirs(new_folder_path, exist_ok=True)
        for folder in os.listdir(dataset_dir):
            if newFolderName in folder and folder in label_to_index_k400.keys() and folder not in skipped_labels:
                folder_path = os.path.join(dataset_dir, folder)
                for i,file in enumerate(os.listdir(folder_path)):
                    
                    if i < 1:
                        source = os.path.join(folder_path, file)
                        destination = os.path.join(new_folder_path, file)
                        print("for label: ", newFolderName, "\nsource: ", source, "\ndestination: ", destination)
                        print("\n")
                        shutil.copy(source, destination)