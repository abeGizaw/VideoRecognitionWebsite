import pandas as pd
import os
import shutil
index_to_label_k400 = {
0:"abseiling",
1:"air drumming",
2:"answering questions",
3:"applauding",
4:"applying cream",
5:"archery",
6:"arm wrestling",
7:"arranging flowers",
8:"assembling computer",
9:"auctioning",
10:"baby waking up",
11:"baking cookies",
12:"balloon blowing",
13:"bandaging",
14:"barbequing",
15:"bartending",
16:"beatboxing",
17:"bee keeping",
18:"belly dancing",
19:"bench pressing",
20:"bending back",
21:"bending metal",
22:"biking through snow",
23:"blasting sand",
24:"blowing glass",
25:"blowing leaves",
26:"blowing nose",
27:"blowing out candles",
28:"bobsledding",
29:"bookbinding",
30:"bouncing on trampoline",
31:"bowling",
32:"braiding hair",
33:"breading or breadcrumbing",
34:"breakdancing",
35:"brush painting",
36:"brushing hair",
37:"brushing teeth",
38:"building cabinet",
39:"building shed",
40:"bungee jumping",
41:"busking",
42:"canoeing or kayaking",
43:"capoeira",
44:"carrying baby",
45:"cartwheeling",
46:"carving pumpkin",
47:"catching fish",
48:"catching or throwing baseball",
49:"catching or throwing frisbee",
50:"catching or throwing softball",
51:"celebrating",
52:"changing oil",
53:"changing wheel",
54:"checking tires",
55:"cheerleading",
56:"chopping wood",
57:"clapping",
58:"clay pottery making",
59:"clean and jerk",
60:"cleaning floor",  #CLEANING
61:"cleaning gutters",
62:"cleaning pool",
63:"cleaning shoes",
64:"cleaning toilet",
65:"cleaning windows",
66:"climbing a rope", #CLIMBING
67:"climbing ladder",
68:"climbing tree",
69:"contact juggling",
70:"cooking chicken",
71:"cooking egg",
72:"cooking on campfire",
73:"cooking sausages",
74:"counting money",
75:"country line dancing",
76:"cracking neck",
77:"crawling baby",
78:"crossing river",
79:"crying",
80:"curling hair",
81:"cutting nails",
82:"cutting pineapple",
83:"cutting watermelon",
84:"dancing ballet",
85:"dancing charleston",
86:"dancing gangnam style",
87:"dancing macarena",
88:"deadlifting",
89:"decorating the christmas tree",
90:"digging",
91:"dining",
92:"disc golfing",
93:"diving cliff",
94:"dodgeball",
95:"doing aerobics",
96:"doing laundry",
97:"doing nails",
98:"drawing",
99:"dribbling basketball",
100:"drinking",
101:"drinking beer",
102:"drinking shots",
103:"driving car",
104:"driving tractor",
105:"drop kicking",
106:"drumming fingers",
107:"dunking basketball",
108:"dying hair",
109:"eating burger", #EATING
110:"eating cake",
111:"eating carrots",
112:"eating chips",
113:"eating doughnuts",
114:"eating hotdog",
115:"eating ice cream",
116:"eating spaghetti",
117:"eating watermelon",
118:"egg hunting",
119:"exercising arm",
120:"exercising with an exercise ball",
121:"extinguishing fire",
122:"faceplanting",
123:"feeding birds",
124:"feeding fish",
125:"feeding goats",
126:"filling eyebrows",
127:"finger snapping",
128:"fixing hair",
129:"flipping pancake",
130:"flying kite",
131:"folding clothes",
132:"folding napkins",
133:"folding paper",
134:"front raises",
135:"frying vegetables",
136:"garbage collecting",
137:"gargling",
138:"getting a haircut",
139:"getting a tattoo",
140:"giving or receiving award",
141:"golf chipping", #Golfing
142:"golf driving",
143:"golf putting",
144:"grinding meat",
145:"grooming dog",
146:"grooming horse",
147:"gymnastics tumbling",
148:"hammer throw",
149:"headbanging",
150:"headbutting",
151:"high jump",
152:"high kick",
153:"hitting baseball",
154:"hockey stop",
155:"holding snake",
156:"hopscotch",
157:"hoverboarding",
158:"hugging",
159:"hula hooping",
160:"hurdling",
161:"hurling (sport)",
162:"ice climbing",
163:"ice fishing",
164:"ice skating",
165:"ironing",
166:"javelin throw",
167:"jetskiing",
168:"jogging",
169:"juggling balls",
170:"juggling fire",
171:"juggling soccer ball",
172:"jumping into pool",
173:"jumpstyle dancing",
174:"kicking field goal",
175:"kicking soccer ball",
176:"kissing",
177:"kitesurfing",
178:"knitting",
179:"krumping",
180:"laughing",
181:"laying bricks",
182:"long jump",
183:"lunge",
184:"making a cake",
185:"making a sandwich",
186:"making bed",
187:"making jewelry",
188:"making pizza",
189:"making snowman",
190:"making sushi",
191:"making tea",
192:"marching",
193:"massaging back", #MASSAGING
194:"massaging feet",
195:"massaging legs",
196:"massaging person's head",
197:"milking cow",
198:"mopping floor",
199:"motorcycling",
200:"moving furniture",
201:"mowing lawn",
202:"news anchoring",
203:"opening bottle",
204:"opening present",
205:"paragliding",
206:"parasailing",
207:"parkour",
208:"passing American football (in game)",
209:"passing American football (not in game)",
210:"peeling apples",
211:"peeling potatoes",
212:"petting animal (not cat)",
213:"petting cat",
214:"picking fruit",
215:"planting trees",
216:"plastering",
217:"playing accordion",
218:"playing badminton",
219:"playing bagpipes",
220:"playing basketball",
221:"playing bass guitar",
222:"playing cards",
223:"playing cello",
224:"playing chess",
225:"playing clarinet",
226:"playing controller",
227:"playing cricket",
228:"playing cymbals",
229:"playing didgeridoo",
230:"playing drums",
231:"playing flute",
232:"playing guitar",
233:"playing harmonica",
234:"playing harp",
235:"playing ice hockey",
236:"playing keyboard",
237:"playing kickball",
238:"playing monopoly",
239:"playing organ",
240:"playing paintball",
241:"playing piano",
242:"playing poker",
243:"playing recorder",
244:"playing saxophone",
245:"playing squash or racquetball",
246:"playing tennis",
247:"playing trombone",
248:"playing trumpet",
249:"playing ukulele",
250:"playing violin",
251:"playing volleyball",
252:"playing xylophone",
253:"pole vault",
254:"presenting weather forecast",
255:"pull ups",
256:"pumping fist",
257:"pumping gas",
258:"punching bag",
259:"punching person (boxing)",
260:"push up",
261:"pushing car",
262:"pushing cart",
263:"pushing wheelchair",
264:"reading book",
265:"reading newspaper",
266:"recording music",
267:"riding a bike",
268:"riding camel",
269:"riding elephant",
270:"riding mechanical bull",
271:"riding mountain bike",
272:"riding mule",
273:"riding or walking with horse",
274:"riding scooter",
275:"riding unicycle",
276:"ripping paper",
277:"robot dancing",
278:"rock climbing",
279:"rock scissors paper",
280:"roller skating",
281:"running on treadmill",
282:"sailing",
283:"salsa dancing",
284:"sanding floor",
285:"scrambling eggs",
286:"scuba diving",
287:"setting table",
288:"shaking hands",
289:"shaking head",
290:"sharpening knives",
291:"sharpening pencil",
292:"shaving head",
293:"shaving legs",
294:"shearing sheep",
295:"shining shoes",
296:"shooting basketball",
297:"shooting goal (soccer)",
298:"shot put",
299:"shoveling snow",
300:"shredding paper",
301:"shuffling cards",
302:"side kick",
303:"sign language interpreting",
304:"singing",
305:"situp",
306:"skateboarding",
307:"ski jumping",
308:"skiing (not slalom or crosscountry)",
309:"skiing crosscountry",
310:"skiing slalom",
311:"skipping rope",
312:"skydiving",
313:"slacklining",
314:"slapping",
315:"sled dog racing",
316:"smoking",
317:"smoking hookah",
318:"snatch weight lifting",
319:"sneezing",
320:"sniffing",
321:"snorkeling",
322:"snowboarding",
323:"snowkiting",
324:"snowmobiling",
325:"somersaulting",
326:"spinning poi",
327:"spray painting",
328:"spraying",
329:"springboard diving",
330:"squat",
331:"sticking tongue out",
332:"stomping grapes",
333:"stretching arm",
334:"stretching leg",
335:"strumming guitar",
336:"surfing crowd",
337:"surfing water",
338:"sweeping floor",
339:"swimming backstroke", #SWIMMING
340:"swimming breast stroke",
341:"swimming butterfly stroke",
342:"swing dancing",
343:"swinging legs",
344:"swinging on something",
345:"sword fighting",
346:"tai chi",
347:"taking a shower",
348:"tango dancing",
349:"tap dancing",
350:"tapping guitar",
351:"tapping pen",
352:"tasting beer",
353:"tasting food",
354:"testifying",
355:"texting",
356:"throwing axe",
357:"throwing ball",
358:"throwing discus",
359:"tickling",
360:"tobogganing",
361:"tossing coin",
362:"tossing salad",
363:"training dog",
364:"trapezing",
365:"trimming or shaving beard",
366:"trimming trees",
367:"triple jump",
368:"tying bow tie",
369:"tying knot (not on a tie)",
370:"tying tie",
371:"unboxing",
372:"unloading truck",
373:"using computer",
374:"using remote controller (not gaming)",
375:"using segway",
376:"vault",
377:"waiting in line",
378:"walking the dog",
379:"washing dishes",
380:"washing feet",
381:"washing hair",
382:"washing hands",
383:"water skiing",
384:"water sliding",
385:"watering plants",
386:"waxing back",
387:"waxing chest",
388:"waxing eyebrows",
389:"waxing legs",
390:"weaving basket",
391:"welding",
392:"whistling",
393:"windsurfing",
394:"wrapping present",
395:"wrestling",
396:"writing",
397:"yawning",
398:"yoga",
399:"zumba",
400:"adjusting glasses"
}


index_to_label_k400_generalized = {
    0: "abseiling",
    1: "adjusting glasses",
    2: "air drumming",
    3: "alligator wrestling",
    4: "answering questions",
    5: "applauding",
    6: "applying cream",
    7: "archery",
    8: "arm wrestling",
    9: "arranging flowers",
    10: "assembling computer",
    11: "auctioning",
    12: "baby waking up",
    13: "baking cookies",
    14: "bandaging",
    15: "barbequing",
    16: "bartending",
    17: "beatboxing",
    18: "bee keeping",
    19: "belly dancing",
    20: "bench pressing",
    21: "bending back",
    22: "bending metal",
    23: "biking through snow",
    24: "blasting sand",
    25: "blending fruit",
    26: "blowing glass",
    27: "blowing leaves",
    28: "blowing nose",
    29: "blowing out candles",
    30: "bobsledding",
    31: "bookbinding",
    32: "bouncing ball (not juggling)",
    33: "bouncing on trampoline",
    34: "bowling",
    35: "braiding hair",
    36: "breading or breadcrumbing",
    37: "breakdancing",
    38: "brush painting",
    39: "brushing hair",
    40: "brushing teeth",
    41: "building cabinet",
    42: "building lego",
    43: "building shed",
    44: "bungee jumping",
    45: "busking",
    46: "canoeing or kayaking",
    47: "capoeira",
    48: "carrying baby",
    49: "cartwheeling",
    50: "carving pumpkin",
    51: "catching fish",
    52: "catching or throwing baseball",
    53: "catching or throwing frisbee",
    54: "catching or throwing softball",
    55: "celebrating",
    56: "changing oil",
    57: "changing wheel (not on bike)",
    58: "checking tires",
    59: "checking watch",
    60: "cheerleading",
    61: "chopping wood",
    62: "clapping",
    63: "clay pottery making",
    64: "clean and jerk",
    65: "cleaning",
    66: "climbing",
    67: "contact juggling",
    68: "cooking chicken",
    69: "cooking egg",
    70: "cooking on campfire",
    71: "cooking sausages (not on barbeque)",
    72: "coughing",
    73: "counting money",
    74: "country line dancing",
    75: "cracking neck",
    76: "crawling baby",
    77: "crossing river",
    78: "crying",
    79: "curling hair",
    80: "cutting nails",
    81: "cutting pineapple",
    82: "cutting watermelon",
    83: "dancing ballet",
    84: "dancing charleston",
    85: "dancing gangnam style",
    86: "dancing macarena",
    87: "deadlifting",
    88: "decorating the christmas tree",
    89: "digging",
    90: "dining",
    91: "directing traffic",
    92: "disc golfing",
    93: "diving cliff",
    94: "dodgeball",
    95: "doing aerobics",
    96: "doing laundry",
    97: "doing nails",
    98: "doing sudoku",
    99: "drawing",
    100: "dribbling basketball",
    101: "drinking shots",
    102: "driving car",
    103: "driving tractor",
    104: "drop kicking",
    105: "drumming fingers",
    106: "dunking basketball",
    107: "dyeing hair",
    108: "eating burger",
    109: "eating cake",
    110: "eating carrots",
    111: "eating chips",
    112: "eating doughnuts",
    113: "eating hotdog",
    114: "eating ice cream",
    115: "eating spaghetti",
    116: "eating watermelon",
    117: "egg hunting",
    118: "exercising arm",
    119: "exercising with an exercise ball",
    120: "extinguishing fire",
    121: "faceplanting",
    122: "feeding birds",
    123: "feeding fish",
    124: "feeding goats",
    125: "filling eyebrows",
    126: "finger snapping",
    127: "fixing hair",
    128: "flipping bottle",
    129: "flipping pancake",
    130: "flying kite",
    131: "folding clothes",
    132: "folding napkins",
    133: "folding paper",
    134: "front raises",
    135: "frying vegetables",
    136: "gargling",
    137: "getting a haircut",
    138: "getting a tattoo",
    139: "giving or receiving award",
    140: "golf chipping",
    141: "golf driving",
    142: "golf putting",
    143: "grinding meat",
    144: "grooming dog",
    145: "grooming horse",
    146: "gymnastics tumbling",
    147: "hammer throw",
    148: "headbanging",
    149: "headbutting",
    150: "high fiving",
    151: "high jump",
    152: "high kick",
    153: "hitting baseball",
    154: "hockey stop",
    155: "holding snake",
    156: "hopscotch",
    157: "hoverboarding",
    158: "hugging (not baby)",
    159: "hugging baby",
    160: "hula hooping",
    161: "hurdling",
    162: "hurling (sport)",
    163: "ice climbing",
    164: "ice fishing",
    165: "ice skating",
    166: "ironing",
    167: "javelin throw",
    168: "jaywalking",
    169: "jetskiing",
    170: "jogging",
    171: "juggling balls",
    172: "juggling fire",
    173: "juggling soccer ball",
    174: "jumping into pool",
    175: "jumpstyle dancing",
    176: "kicking field goal",
    177: "kicking soccer ball",
    178: "kissing",
    179: "kitesurfing",
    180: "knitting",
    181: "krumping",
    182: "laughing",
    183: "laying bricks",
    184: "listening with headphones",
    185: "long jump",
    186: "lunge",
    187: "making a cake",
    188: "making a sandwich",
    189: "making jewelry",
    190: "making pizza",
    191: "making snowman",
    192: "making sushi",
    193: "making tea",
    194: "making the bed",
    195: "marching",
    196: "massaging",
    197: "milking cow",
    198: "milking goat",
    199: "mopping floor",
    200: "motorcycling",
    201: "moving baby",
    202: "moving furniture",
    203: "mowing lawn",
    204: "news anchoring",
    205: "opening bottle (not wine)",
    206: "opening present",
    207: "paragliding",
    208: "parasailing",
    209: "parkour",
    210: "passing American football",
    211: "peeling apples",
    212: "peeling potatoes",
    213: "petting animal (not cat)",
    214: "petting cat",
    215: "picking apples",
    216: "picking blueberries",
    217: "planting trees",
    218: "plastering",
    219: "playing accordion",
    220: "playing badminton",
    221: "playing bagpipes",
    222: "playing basketball",
    223: "playing bass guitar",
    224: "playing cards",
    225: "playing cello",
    226: "playing chess",
    227: "playing clarinet",
    228: "playing controller",
    229: "playing cricket",
    230: "playing cymbals",
    231: "playing didgeridoo",
    232: "playing drums",
    233: "playing flute",
    234: "playing guitar",
    235: "playing harmonica",
    236: "playing harp",
    237: "playing ice hockey",
    238: "playing keyboard",
    239: "playing kickball",
    240: "playing monopoly",
    241: "playing organ",
    242: "playing paintball",
    243: "playing piano",
    244: "playing poker",
    245: "playing recorder",
    246: "playing saxophone",
    247: "playing slot machine",
    248: "playing squash or racquetball",
    249: "playing tennis",
    250: "playing trombone",
    251: "playing trumpet",
    252: "playing ukulele",
    253: "playing violin",
    254: "playing volleyball",
    255: "playing xylophone",
    256: "pole vault",
    257: "presenting weather forecast",
    258: "pull ups",
    259: "pumping fist",
    260: "pumping gas",
    261: "punching bag",
    262: "punching person (boxing)",
    263: "push up",
    264: "pushing car",
    265: "pushing cart",
    266: "pushing wheelchair",
    267: "reading book",
    268: "reading newspaper",
    269: "recording music",
    270: "riding a bike",
    271: "riding camel",
    272: "riding elephant",
    273: "riding mechanical bull",
    274: "riding mule",
    275: "riding or walking with horse",
    276: "riding scooter",
    277: "riding unicycle",
    278: "ripping paper",
    279: "robot dancing",
    280: "rock climbing",
    281: "rock scissors paper",
    282: "roller skating",
    283: "running on treadmill",
    284: "sailing",
    285: "salsa dancing",
    286: "sanding floor",
    287: "scrambling eggs",
    288: "scuba diving",
    289: "setting table",
    290: "shaking hands",
    291: "shaking head",
    292: "sharpening knives",
    293: "sharpening pencil",
    294: "shaving head",
    295: "shaving legs",
    296: "shearing sheep",
    297: "shining shoes",
    298: "shoot dance",
    299: "shooting basketball",
    300: "shooting goal (soccer)",
    301: "shot put",
    302: "shouting",
    303: "shoveling snow",
    304: "shredding paper",
    305: "shuffling cards",
    306: "side kick",
    307: "sign language interpreting",
    308: "singing",
    309: "situp",
    310: "skateboarding",
    311: "ski jumping",
    312: "skiing crosscountry",
    313: "skiing mono",
    314: "skiing slalom",
    315: "skipping rope",
    316: "skydiving",
    317: "slacklining",
    318: "slapping",
    319: "sled dog racing",
    320: "smoking",
    321: "smoking hookah",
    322: "snatch weight lifting",
    323: "sneezing",
    324: "snorkeling",
    325: "snowboarding",
    326: "snowkiting",
    327: "snowmobiling",
    328: "somersaulting",
    329: "spinning poi",
    330: "splashing water",
    331: "spray painting",
    332: "spraying",
    333: "springboard diving",
    334: "squat",
    335: "sticking tongue out",
    336: "stomping grapes",
    337: "stretching arm",
    338: "stretching leg",
    339: "surfing crowd",
    340: "surfing water",
    341: "sweeping floor",
    342: "swimming",
    343: "swing dancing",
    344: "swinging on something",
    345: "sword fighting",
    346: "tai chi",
    347: "tango dancing",
    348: "tap dancing",
    349: "tapping guitar",
    350: "tapping pen",
    351: "tasting beer",
    352: "tasting food",
    353: "testifying",
    354: "texting",
    355: "throwing axe",
    356: "throwing ball (not baseball or American football)",
    357: "throwing discus",
    358: "tickling",
    359: "tobogganing",
    360: "tossing coin",
    361: "tossing salad",
    362: "training dog",
    363: "trapezing",
    364: "trimming or shaving beard",
    365: "trimming trees",
    366: "triple jump",
    367: "tying bow tie",
    368: "tying knot (not on a tie)",
    369: "tying necktie",
    370: "unboxing",
    371: "uncorking champagne",
    372: "unloading truck",
    373: "using megaphone",
    374: "using remote controller (not gaming)",
    375: "using segway",
    376: "wading through mud",
    377: "waiting in line",
    378: "waking up",
    379: "walking the dog",
    380: "washing dishes",
    381: "washing feet",
    382: "washing hair",
    383: "washing hands",
    384: "watching tv",
    385: "water skiing",
    386: "water sliding",
    387: "watering plants",
    388: "waxing",
    389: "weaving basket",
    390: "welding",
    391: "whistling",
    392: "windsurfing",
    393: "winking",
    394: "wrapping present",
    395: "wrestling",
    396: "writing",
    397: "yawning",
    398: "yoga",
    399: "zumba",
}
    

label_to_index_k400 = {label: idx for idx, label in index_to_label_k400.items()}
label_to_index_k400_generalized = {label: idx for idx, label in index_to_label_k400_generalized.items()}

unwanted_labels = ["Doing other things", "no gesture"]
new_classes = ['adjusting glasses'] # , 'acting in play', 'alligator wrestling']


generalized = ['cleaning', 'climbing', 'massaging', 'passing American football', 'swimming', 'waxing']
skipped_labels = ['ice climbing','rock climbing']
# df = pd.DataFrame(list(index_to_label_k400.items()))
# df.to_csv('400mappings.csv',index=False)
# print(os.getcwd())



def combineLabels(dataset_dir, num_videos_to_copy, data_type):
    """
    Generalizes the labels in the dataset to the new classes
    Loops through the dataset directory and copies the specified number of videos for each new class 
    """
    base_dir = os.path.abspath(os.path.join(os.path.dirname(__file__), '..', '..','..','generalizedData', f'{data_type}'))
    print('base',base_dir)
    for newFolderName in generalized:
        new_folder_path = os.path.join(base_dir, newFolderName)
        os.makedirs(new_folder_path, exist_ok=True)
        count = sum(1 for label in index_to_label_k400.values() if newFolderName in label)
        for folder in os.listdir(dataset_dir):
            if newFolderName in folder and folder in label_to_index_k400.keys() and folder not in skipped_labels:
                folder_path = os.path.join(dataset_dir, folder)
                for i, file in enumerate(os.listdir(folder_path)):
                   if i < num_videos_to_copy / count:
                    source = os.path.join(folder_path, file)
                    destination = os.path.join(new_folder_path, file)
                    print(f"for label: {newFolderName}\nsource: {source}\ndestination: {destination}\n")
                    shutil.copy(source, destination)
                